---
title: ios-MDM
date: 2019-04-04 08:53:33
categories:
- iOS
tags:
---

![](https://ws4.sinaimg.cn/large/006tKfTcly1g1qbfp0bj3j30en055q31.jpg)

从上图可以看出要实现MDM服务须涉及到

1. 苹果推送服务器APNs
2. 自己的或者第三方提供的MDM服务器
3. 受管理的设备。

三者之间通过HTTPS相互通信，所以推送和普通APP推送一样必须要有推送证书。

- MDM服务器：发送指令对设备进行管理，获取相关信息及操作，回应响应设备操作。向APNs发送一个命令，目的来唤醒设备去主动连接MDM服务器，报告其当前状态是否处于空闲（若设备空闲，MDM服务器会继续下一步操作比如开始发送指令）。

- APNs：可看作其他两者之间的信使，主要就是转发MDM服务器指令给设备，意思告诉设备开始去连接服务器

- 设备：首先通过Safari访问服务器安装一个配置描述文件并登记注册使其成为受管理的设备，当收到APNs指令后，根据已安装的配置文件的url 连接MDM服务器并报告其状态，然后接受下一步命令，设备收到XML格式的指令后再向服务器传送其相关查询的信息，如果不需要继续发送指令，服务器关闭连接。



所以完成一次指令推送经历以下过程：

- 1、server 与APNs建立连接，发送数据。
- 2、当设备收到APNs推送消息时，主动连接server报告本身的状态空闲
- 3、server收到设备发来的状态信息，发出操作命令
- 4、设备收到命令执行，并返回数据
- 5、server响应，此次查询完成，连接关闭。

